# TargetBulkUpload
Bulk upload of metadata to TaRGET II DCC

## Install python3

## Prepare library (if necessary)
```
pip3 install xlrd
```

## Description
This script can be used to upload metadata to the TaRGET II DCC metadata database from a specific Excel template. 
You can use it to:
1. Upload new metedata to the database;
2. Update existing records in the database;
3. Establish relationships between metadata records.

## How to use it
1. Obtain your personal API key.
	* Visit http://target.wustl.edu:8002/login.
	* Log in with your user name and password.
	* Click "Show API key".
	* Copy your API key string.
2. Fill in the Excel template accordingly. You must use the template in the repo. Don't rename the template; if you have to rename it, keep the version number intact in the name.
	* To upload new data, leave the "System Accession" column blank.
	* "User Accession" can be used to establish relationships with other records in the same Excel file. Please fill in "User Accession" according to our accession rules (see "Instructions" tab and individual tab headers).
	* "User Accessions" must be unique within each Excel file. But you can use the same "User Accession" again in another Excel file in another upload batch.
	* You can leave "User Accession" blank if you don't need to establish any relationship for that record.
	* To update data in the database, fill in all the applicable columns along with the "System Accession" generated by the database.
	* To update existing data, you can assign a unique "User Accession" or leave the "User Accession" column blank.
	* If both "Systerm Accession" and "User Accession" are used, either of them can be used to establish relationships.
	* All the dates in the Excel can be a date type in Excel format or a string in format "YYYY-MM-DD". Don't worry if Excel changes the date format automatically (it means Excel knows it is a date).
	* The relationship columns are labeled with a different color on the right side in each sheet. It should be either a "User Accession" in the same Excel file or an existing "System Accession" in the database.
3. Run it with following command in test mode:
```
python3 submission.py -k <API key> -x <excel file>
```
4. If there is no error during the test run, you can upload the same Excel file to the production database with the following command (please don't use the following command and contact us if there is any unexpected warning or error):
```
python3 submission.py -k <API key> -x <excel file> --notest
```
